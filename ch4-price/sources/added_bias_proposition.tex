\subsection{Added Bias}

\begin{prop}[\ref{prop:added_bias}]
The estimator in Algorithm \ref{alg:estimate} has $O(1/n)$ bias.
\end{prop}
\begin{proof}

The bias $B$ is

\begin{align}
B &= \left| \mathbb{E}[\widetilde{\mu}] - \mu \right| \\
&= \left| \mathbb{E}[\frac{1}{n} \sum_i y^{(i)} - \hat{\alpha} g(z^{(i)})] - \mu \right|
\end{align}

Since $\mathbb{E}[y^{(i)}] = \mu$,

\begin{align}
B&= \left| \mu - \frac{1}{n} \sum_i \mathbb{E}[\hat{\alpha} g(z^{(i)})] - \mu \right| \\
&=\left| \frac{1}{n} \sum_i \mathbb{E}[\hat{\alpha} g(z^{(i)})] \right| \\
&=\left| \frac{1}{n^2} \sum_{i,j} \mathbb{E}[(y^{(j)} - \overline{y}) g(z^{(j)}) g(z^{(i)})]\right| \\
&=\left| \frac{1}{n^2} \sum_{i,j} \mathbb{E}[y^{(j)} g(z^{(j)}) g(z^{(i)})] - \frac{1}{n^3} \sum_{i,j,k} \mathbb{E}[y^{(k)} g(z^{(j)}) g(z^{(i)})] \right| 
\end{align}

Because $Y(z)$ is independent and has mean $f(z)$,

\begin{align}
B=\left| \frac{1}{n^2} \sum_{i,j} \mathbb{E}[f(z^{(j)}) g(z^{(j)}) g(z^{(i)})] - \frac{1}{n^3} \sum_{i,j,k} \mathbb{E}[f(z^{(k)}) g(z^{(j)}) g(z^{(i)})] \right| 
\end{align}

Because $g(z)$ is mean zero and the $z^{(i)}$ are drawn independently,

\begin{align}
B &= \left| \frac{1}{n^2} \sum_{i} \mathbb{E}[f(z^{(i)}) g(z^{(i)})^2] - \frac{1}{n^3} \sum_{i,k} \mathbb{E}[f(z^{(k)}) g(z^{(i)})^2] \right| \\
&= \left| \frac{1}{n^2} \sum_{i} O(1) - \frac{1}{n^3} \sum_{i,k} O(1) \right| \\
&= \left| \frac{1}{n^2} O(n) - \frac{1}{n^3} O(n^2) \right| \\
&= \left| O \left(\frac{1}{n} \right) - O \left(\frac{1}{n} \right) \right| \\
&= O \left(\frac{1}{n} \right) 
\end{align}


\end{proof}
